name: Release on SemVer Tag

on:
  push:
  # pull_request event is required only for autolabeler
    tags:
    - 'v*.*.*'
jobs:
  update_release_draft:
    runs-on: ubuntu-latest
    steps:
      - name: checkout
        uses: actions/checkout@v2
      # Drafts your next Release notes as Pull Requests are merged into "master"
      - name: draft-release
        id: draft-release-id
        uses: release-drafter/release-drafter@v5
        # (Optional) specify config name to use, relative to .github/. Default: release-drafter.yml
        # with:
        #   config-name: my-config.yml
        #   disable-autolabeler: true
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      #- name: build deb
      #  uses: jiro4989/build-deb-action@v2
      #  with:
      #    package: solar
      #    package_root: solar_raspbian
      #    maintainer: Oli
      #    version: ${{ github.ref }} # refs/tags/v*.*.*
      #    arch: 'armel'
      #    depends: 'python3, wiringpi'
      #    desc: 'ladex10 systemd service '
      - name: Upload Deb as Release Asset
        run: echo "upload url is ${{ steps.draft-release.outputs.upload_url }}"; echo "upload url is ${{ steps.draft-release-id.outputs.upload_url }}"
        #id: upload-release-asset
        #uses: actions/upload-release-asset@v1
        #env:
        #  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        #with:
        #  upload_url: ${{ steps.draft-release.outputs.upload_url }}
        #  asset_path: ./*.deb
        #  asset_name: "*.deb"
        #  asset_content_type: application/deb